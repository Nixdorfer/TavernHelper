# TavernHelper(酒馆助手)使用说明书

## 目录

- [世界树](#tree)

- [聊天](#chat)

    - [新建聊天](#)

    - [聊天列表](#)

    - [绑定世界树](#)

    - [聊天界面](#)

        - [修订](#)

        - [撤回](#)

        - [流式传输](#)

        - [自动滚动](#)

        - [折叠参数](#)

        - [插件/MOD](#)

        - [自动生长世界树](#)

        - [自动生图词](#)

        - [GalGame模式](#)

- [草稿箱](#draft)

- [创作](#creation)

- [图库](#gallery)

- [广场](#plaza)

- [设置](#setting)

- [调试](#debug)

## 世界树 {#tree}

世界树是由若干条以根节点为原点的世界线组成的 每条世界线可能包含若干个节点

### 节点 {#tree-node}

节点的形象的解释如下

故事发生的初始场景为根节点`假设初始场景位于A`

当事情开始发生变化`例如场景变为B`此时会生长出一个新的节点 代表当前的即时状态

当一件事发生 并且面临多个抉择时 会导致多条以当前节点为原点的世界线出现`比如去场景C/D/E`

当一个新的人物出现时 词条便会自动生长出该人物的设定 所有以当前节点为根的子节点都会继承该设定

因此可以说 节点是某一个事件发生时这个世界状态的快照 这位回溯和增加平行世界线提供了基础

#### 根节点 {#tree-root}

根节点是故事发生时的初始场景 因此

- 如果您的项目类型为`创作`那么根节点应该包含您的所有设定内容

- 如果您的项目类型为`游玩`那么根节点应该为空 或者包含您的基础信息

#### 新建节点 {#tree-new}

您可以手动管理节点

- 对于`游玩`型项目 这常见于希望在某处发起平行世界线 同时不对其子节点产生影响时 但一般情况下 AI会自动管理节点

- 对于`创作`型项目 这可以帮助您梳理思路 以及开辟不同的开始场景

#### 新建分支标记 {#tree-tag}

当您右键点击一个非根节点时 可以为该节点与其父节点之间增加一个标记 该标记仅用于标识 不参与实际内容生成

这常见于分裂出多世界线的节点 可以标记每一条新世界线是由于何种决定而诞生的

#### 提示词 {#tree-prompt}

提示词分为前置提示词(也即`前置词`) 后置提示词(也即`后置词`)和全局提示词(也即`提示词`)

##### 系统提示词 {#tree-prompt-system}

系统提示词是一种特殊的卡片 只要你发送一条消息 系统提示词就会无条件附加在指定位置 不受任何内容触发或影响

##### 卡片 {#tree-prompt-card}

卡片为会被同样触发词触发的对象的最小单位 每个卡片都包括基础 触发词 词条 生图词

###### 触发词 {#tree-prompt-trigger}

触发词拥有和/或两种模式 您可以添加若干个词

和模式代表所有的词必须全部被指定内容命中才会触发该卡片 或模式代表只要列表中的词被指定内容命中一个就会触发该卡片

###### 词条 {#tree-prompt-block}

词条以块(block)为单位 每个块可以设置触发区域为

- 系统 即提示词区域 该区域使用较少 因为可能会被链式触发导致token浪费

- 用户 即您输入的内容 该区域最常见 这会在您发送消息时立刻触发世界书并附加给AI 在回复前就可以获知相关内容

- AI 即来自AI的回复 该区域最常见 这会在AI的回复中提到某个对象时 在下次回复中附加给AI 但由于AI下次才能获知相关内容的延迟触发机制 通常会导致该次回复的设定异常

为一个块键入标题即可自动新建该块

每个块的每一行前都有一个同步点(Sync Dot)代表该行的状态 拥有三种颜色

- 绿色 代表该行被其所有子节点继承 如果该节点没有子节点 则必定为绿色

- 红色 代表该行被其所有子节点移除

- 黄色 只有在该节点拥有多个子节点时才会出现 代表该行在一部分子节点中被继承 在另外一部分中被移除

以及两种形状

- 圆形 代表该行是从其父节点继承而来的

- 三角 代表该行不存在于其父节点 即该行在该节点被首次添加

换句话说

- 如果同步点为红色三角 则代表这一行仅存在于当前节点 既不在父节点 又被所有子节点移除了

- 如果同步点为红色圆 则代表这一行在该节点被结束

当您在一个节点中添加一行后 这一行会默认在相同的位置 继承到其所有子节点 您也可以在其直系子节点中删除该行来避免继续传播

当您点击同步点 可以复制该行的行序列号(Line SN)

该行序列号在一个项目中唯一 也就是说每两行的行序列号一定不同

行序列号包含小写字母/大写字母/数字 从小到大顺序为a-zA-Z0-9 基础长度为4 最大长度为8

换句话说 这是一个可以表达最多大约2.18x10^14个数字的62进制数

不过一般情况下您不会需要该序列号

###### 生图词 {#tree-prompt-t2i}

生图词为该对象(尤其是人或动物)具有的静态特性 例如性别 身高 身材 发色 瞳色等

动态属性 例如服装 穿衣风格等不应包含在内

抽象属性 例如社会关系等不应包含在内

在您开启了自动生图模式时 该串内容会被上送至AI进行处理

## 聊天 {#chat}

### 新建聊天 {#chat-new}

### 聊天列表 {#chat-list}

### 绑定世界树 {#chat-tree}

### 聊天界面 {#chat-ui}

#### 修订 {#chat-ui-revision}

#### 撤回 {#chat-ui-withdraw}

#### 流式传输 {#chat-ui-stream}

#### 自动滚动 {#chat-ui-rolldown}

#### 折叠参数 {#chat-ui-option}

#### (仅风月)插件/MOD {#chat-ui-mod}

#### 自动生长世界树 {#chat-ui-tree}

#### 自动生图词 {#chat-ui-t2i}

#### GalGame模式 {#chat-ui-galgame}

## 草稿箱 {#draft}

草稿箱默认会捕获剪贴板中的内容 您可以随时关闭该功能

## 创作 {#creation}

## 图库 {#gallery}

您可以进行以下操作

- 导入图片

- 新建文件夹

- 将文件夹/图片拖动到文件夹上加入文件夹

- 将文件夹/图片拖到顶部路径上加入上级文件夹

- 右键删除文件夹/图片

- 右键给文件夹/图片重命名

- 双击文件夹/图片名字为其快速重命名

- 在空白处拖动鼠标快速选择多个对象

## 广场 {#plaza}

您可以在设置中启动无图模式 这将仅显示剧本名称而完全不显示图片(包括点开剧本详情)

### 我的收藏

该功能仅在登录后可用

## 设置 {#setting}

## 调试 {#debug}

该功能仅在以Run.cmd -d启动的dev客户端中可用